# Data Analysis: PowerBI Report

## Project Description:
Project to gather, clean and analyse information and then turn it into PowerBI reports. 

## Breakdown of Project:
### Import Data into PowerBI
Imported 3 different data sources from Azure SQL Database, Azure Blob Storage and CSV files. Apart from changing the data type and renaming columns to meet the naming convention, I used the following tools to get the data into the needed format:
- Remove columns: remove sensitive information like card number or anything that could affect GDPR. 
- Remove rows (duplicates or empty): remove duplicates of unique identifiers and blank rows that might suggest an inaccurate record. 
- Column by example: create separate columns from existing ones using pattern recognition ex: creating a weight unit column from an existing column containing weight values and weight units. 
- Calculated column: create new columns based on calculations using existing columns
- Split column by delimiter: split column into separate ones that are more useful for data exploration

### Build Data Model
Created extra columns in the code and tables to make the data analysis easier, a measures table to contain all the measures and date and geographical hierarchies to help filter dates and locations to generate more focused and specific queries. Set the star-based schema by adding relationships between the tables in ‘model view’, connecting the ‘primary key’ columns between tables to allow queries between multiple tables.

### Set up Report
Created the different report pages and added a navigation sidebar to allow the users to move between pages easily. The functionality behind it was created in the Cross Filtering and Navigation section. 

### Create the Customer Detail Page
Created a report page for customer-level analysis, focusing on the amount of profit, revenue and number of orders generated by customers. The following visuals were created for the report:
- Card visuals: show key information clearly like total revenue by customer
- Tables: show detailed information about each customer to understand customer base 
- Charts: show trends in customer spending based on country and product category
- Date slicer: to allow the user to filter results for specific date ranges
![cust det](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/ec7685af-a75d-4c1a-a78c-16a9d38e0971)


### Create the Executive Summary Page
Created a report page for a high-level summary of the company’s performance that focuses on checking outcomes against key targets. The following visuals were created for the report:
- Card visuals: show key information about revenue, profit and orders 
- Charts: show trends in revenue by country, store type, product category and by date
- KPI visuals: show progress towards meeting targets for revenue, order numbers and profit based on each fiscal quarter
![image](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/c0c55e7f-4531-4af1-9e32-1dbb3352e342)


### Create the Product Detail Page
Created a report page focusing on product details and how product category and store location affect the overall profit. A slicer toolbar was also made to make it easier to filter the products without cluttering the main report page, making it easier for the user to filter results by location and product category. 
The following visuals were created for the report:
- Gauge visuals: show orders, profit and revenue against targets. 
- Card visuals: show key information clearly like the product with the highest revenue
- Charts: show patterns in sale date and revenue from each product category
- Table: show more details for highest-revenue products
- Graph: show profit from each product category and which products were the most successful in each category
![prod de](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/d37a3ed6-c1bb-49bf-b62c-534bb27c08a4)


### Create the Stores Map Page
Created a ‘Stores Map’ report page that is used to filter the information shown on the ‘Stores Drillthrough’ page, focusing on the profitability and financial targets of the selected store. 
For the main Stores Map page, a map visualisation was created as well as:
- A slicer to make filtering results by country easier. 
- A drillthrough feature linked to another page, giving more details about the store selected 
- A tooltip to show the selected store’s progress towards the 20% profit increase target

The following visuals were created for the Stores Drillthrough page:
- Cards: show key information like profit, revenue, number of orders and location.
- Table: show details for the 5 products with the highest revenue
- Charts: showing the number of orders for each product category
- Gauge visuals: show profit and revenue against targets
![st map](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/16e1fae9-3a2f-48c2-8cb6-a1b2fa24fec9)
![st drill](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/378e371e-ef5e-4f0e-b0d8-3c0bd94677e3)
![st tool](https://github.com/CJ1608/data-analytics-power-bi-report493/assets/128046995/33be641d-a2f7-4b08-b7a0-cf9bccb6ca4a)


### Cross Filtering and Navigation
Cross Filtering: 
This section involved going back through the report pages and editing the interactions between the visualisations on each page so that they wouldn’t give potentially misleading information to the user. For example, by making sure the company’s overall Key Performance Indicator (KPI) visualisations are not affected by information selected in other visualisations. 

Navigation:
This involved formatting ‘buttons’ on the navigation sidebar to allow users to switch between report pages. 

### Create Metrics for Users Outside the Company using SQL
This section involved writing a Python script to connect to a PostgresQL database server and run SQL queries within the code editor. 

## Installation Instructions:
- Clone repo : https://github.com/CJ1608/data-analytics-power-bi-report493.git
- Install: Pandas 2.1.3, SQLAlchemy 2.0.23 and PyYaml 6.0.1

## File Structure of the Project:
- PowerBI Report: finished PowerBI Report with pages for product, customer, executive and store location reports
- README.mxd
- data_extraction.py: file containing methods to extract data from data sources
- db_utils.py: file containing methods to connect to databases
- main.py: main file calling on classes and methods from the above .py files
- SQL query results (results from SQL queries shown in main.py)
    - question1.csv
    - question2.csv
    - question3.csv
    - question4.csv
    - question5.csv

## License Information:
Distributed under the MIT License. See LICENSE.txt for more information.

## Contact: 

### Email 
128046995+CJ1608@users.noreply.github.com

### Repo Link 
https://github.com/CJ1608/data-analytics-power-bi-report493.git

## Acknowledgments 
- https://choosealicense.com/
- AiCore
